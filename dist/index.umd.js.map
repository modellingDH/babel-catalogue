{"version":3,"file":"index.umd.js","sources":["../node_modules/react/cjs/react-jsx-runtime.production.js","../node_modules/react/cjs/react-jsx-runtime.development.js","../node_modules/react/jsx-runtime.js","../node_modules/zustand/esm/vanilla.mjs","../node_modules/zustand/esm/react.mjs","../stores/bookStore.ts","../components/Book/BookContext.tsx","../components/Book/Page.tsx","../hooks/useCoverTexture.ts","../components/Book/Cover.tsx","../components/Book/Spine.tsx","../components/Book/Particles.tsx","../components/Book/Book.tsx","../components/Book/Scene.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n  REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\");\nfunction jsxProd(type, config, maybeKey) {\n  var key = null;\n  void 0 !== maybeKey && (key = \"\" + maybeKey);\n  void 0 !== config.key && (key = \"\" + config.key);\n  if (\"key\" in config) {\n    maybeKey = {};\n    for (var propName in config)\n      \"key\" !== propName && (maybeKey[propName] = config[propName]);\n  } else maybeKey = config;\n  config = maybeKey.ref;\n  return {\n    $$typeof: REACT_ELEMENT_TYPE,\n    type: type,\n    key: key,\n    ref: void 0 !== config ? config : null,\n    props: maybeKey\n  };\n}\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.jsx = jsxProd;\nexports.jsxs = jsxProd;\n","/**\n * @license React\n * react-jsx-runtime.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function getComponentNameFromType(type) {\n      if (null == type) return null;\n      if (\"function\" === typeof type)\n        return type.$$typeof === REACT_CLIENT_REFERENCE\n          ? null\n          : type.displayName || type.name || null;\n      if (\"string\" === typeof type) return type;\n      switch (type) {\n        case REACT_FRAGMENT_TYPE:\n          return \"Fragment\";\n        case REACT_PROFILER_TYPE:\n          return \"Profiler\";\n        case REACT_STRICT_MODE_TYPE:\n          return \"StrictMode\";\n        case REACT_SUSPENSE_TYPE:\n          return \"Suspense\";\n        case REACT_SUSPENSE_LIST_TYPE:\n          return \"SuspenseList\";\n        case REACT_ACTIVITY_TYPE:\n          return \"Activity\";\n      }\n      if (\"object\" === typeof type)\n        switch (\n          (\"number\" === typeof type.tag &&\n            console.error(\n              \"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"\n            ),\n          type.$$typeof)\n        ) {\n          case REACT_PORTAL_TYPE:\n            return \"Portal\";\n          case REACT_CONTEXT_TYPE:\n            return type.displayName || \"Context\";\n          case REACT_CONSUMER_TYPE:\n            return (type._context.displayName || \"Context\") + \".Consumer\";\n          case REACT_FORWARD_REF_TYPE:\n            var innerType = type.render;\n            type = type.displayName;\n            type ||\n              ((type = innerType.displayName || innerType.name || \"\"),\n              (type = \"\" !== type ? \"ForwardRef(\" + type + \")\" : \"ForwardRef\"));\n            return type;\n          case REACT_MEMO_TYPE:\n            return (\n              (innerType = type.displayName || null),\n              null !== innerType\n                ? innerType\n                : getComponentNameFromType(type.type) || \"Memo\"\n            );\n          case REACT_LAZY_TYPE:\n            innerType = type._payload;\n            type = type._init;\n            try {\n              return getComponentNameFromType(type(innerType));\n            } catch (x) {}\n        }\n      return null;\n    }\n    function testStringCoercion(value) {\n      return \"\" + value;\n    }\n    function checkKeyStringCoercion(value) {\n      try {\n        testStringCoercion(value);\n        var JSCompiler_inline_result = !1;\n      } catch (e) {\n        JSCompiler_inline_result = !0;\n      }\n      if (JSCompiler_inline_result) {\n        JSCompiler_inline_result = console;\n        var JSCompiler_temp_const = JSCompiler_inline_result.error;\n        var JSCompiler_inline_result$jscomp$0 =\n          (\"function\" === typeof Symbol &&\n            Symbol.toStringTag &&\n            value[Symbol.toStringTag]) ||\n          value.constructor.name ||\n          \"Object\";\n        JSCompiler_temp_const.call(\n          JSCompiler_inline_result,\n          \"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.\",\n          JSCompiler_inline_result$jscomp$0\n        );\n        return testStringCoercion(value);\n      }\n    }\n    function getTaskName(type) {\n      if (type === REACT_FRAGMENT_TYPE) return \"<>\";\n      if (\n        \"object\" === typeof type &&\n        null !== type &&\n        type.$$typeof === REACT_LAZY_TYPE\n      )\n        return \"<...>\";\n      try {\n        var name = getComponentNameFromType(type);\n        return name ? \"<\" + name + \">\" : \"<...>\";\n      } catch (x) {\n        return \"<...>\";\n      }\n    }\n    function getOwner() {\n      var dispatcher = ReactSharedInternals.A;\n      return null === dispatcher ? null : dispatcher.getOwner();\n    }\n    function UnknownOwner() {\n      return Error(\"react-stack-top-frame\");\n    }\n    function hasValidKey(config) {\n      if (hasOwnProperty.call(config, \"key\")) {\n        var getter = Object.getOwnPropertyDescriptor(config, \"key\").get;\n        if (getter && getter.isReactWarning) return !1;\n      }\n      return void 0 !== config.key;\n    }\n    function defineKeyPropWarningGetter(props, displayName) {\n      function warnAboutAccessingKey() {\n        specialPropKeyWarningShown ||\n          ((specialPropKeyWarningShown = !0),\n          console.error(\n            \"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)\",\n            displayName\n          ));\n      }\n      warnAboutAccessingKey.isReactWarning = !0;\n      Object.defineProperty(props, \"key\", {\n        get: warnAboutAccessingKey,\n        configurable: !0\n      });\n    }\n    function elementRefGetterWithDeprecationWarning() {\n      var componentName = getComponentNameFromType(this.type);\n      didWarnAboutElementRef[componentName] ||\n        ((didWarnAboutElementRef[componentName] = !0),\n        console.error(\n          \"Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.\"\n        ));\n      componentName = this.props.ref;\n      return void 0 !== componentName ? componentName : null;\n    }\n    function ReactElement(type, key, props, owner, debugStack, debugTask) {\n      var refProp = props.ref;\n      type = {\n        $$typeof: REACT_ELEMENT_TYPE,\n        type: type,\n        key: key,\n        props: props,\n        _owner: owner\n      };\n      null !== (void 0 !== refProp ? refProp : null)\n        ? Object.defineProperty(type, \"ref\", {\n            enumerable: !1,\n            get: elementRefGetterWithDeprecationWarning\n          })\n        : Object.defineProperty(type, \"ref\", { enumerable: !1, value: null });\n      type._store = {};\n      Object.defineProperty(type._store, \"validated\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: 0\n      });\n      Object.defineProperty(type, \"_debugInfo\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: null\n      });\n      Object.defineProperty(type, \"_debugStack\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugStack\n      });\n      Object.defineProperty(type, \"_debugTask\", {\n        configurable: !1,\n        enumerable: !1,\n        writable: !0,\n        value: debugTask\n      });\n      Object.freeze && (Object.freeze(type.props), Object.freeze(type));\n      return type;\n    }\n    function jsxDEVImpl(\n      type,\n      config,\n      maybeKey,\n      isStaticChildren,\n      debugStack,\n      debugTask\n    ) {\n      var children = config.children;\n      if (void 0 !== children)\n        if (isStaticChildren)\n          if (isArrayImpl(children)) {\n            for (\n              isStaticChildren = 0;\n              isStaticChildren < children.length;\n              isStaticChildren++\n            )\n              validateChildKeys(children[isStaticChildren]);\n            Object.freeze && Object.freeze(children);\n          } else\n            console.error(\n              \"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\"\n            );\n        else validateChildKeys(children);\n      if (hasOwnProperty.call(config, \"key\")) {\n        children = getComponentNameFromType(type);\n        var keys = Object.keys(config).filter(function (k) {\n          return \"key\" !== k;\n        });\n        isStaticChildren =\n          0 < keys.length\n            ? \"{key: someKey, \" + keys.join(\": ..., \") + \": ...}\"\n            : \"{key: someKey}\";\n        didWarnAboutKeySpread[children + isStaticChildren] ||\n          ((keys =\n            0 < keys.length ? \"{\" + keys.join(\": ..., \") + \": ...}\" : \"{}\"),\n          console.error(\n            'A props object containing a \"key\" prop is being spread into JSX:\\n  let props = %s;\\n  <%s {...props} />\\nReact keys must be passed directly to JSX without using spread:\\n  let props = %s;\\n  <%s key={someKey} {...props} />',\n            isStaticChildren,\n            children,\n            keys,\n            children\n          ),\n          (didWarnAboutKeySpread[children + isStaticChildren] = !0));\n      }\n      children = null;\n      void 0 !== maybeKey &&\n        (checkKeyStringCoercion(maybeKey), (children = \"\" + maybeKey));\n      hasValidKey(config) &&\n        (checkKeyStringCoercion(config.key), (children = \"\" + config.key));\n      if (\"key\" in config) {\n        maybeKey = {};\n        for (var propName in config)\n          \"key\" !== propName && (maybeKey[propName] = config[propName]);\n      } else maybeKey = config;\n      children &&\n        defineKeyPropWarningGetter(\n          maybeKey,\n          \"function\" === typeof type\n            ? type.displayName || type.name || \"Unknown\"\n            : type\n        );\n      return ReactElement(\n        type,\n        children,\n        maybeKey,\n        getOwner(),\n        debugStack,\n        debugTask\n      );\n    }\n    function validateChildKeys(node) {\n      isValidElement(node)\n        ? node._store && (node._store.validated = 1)\n        : \"object\" === typeof node &&\n          null !== node &&\n          node.$$typeof === REACT_LAZY_TYPE &&\n          (\"fulfilled\" === node._payload.status\n            ? isValidElement(node._payload.value) &&\n              node._payload.value._store &&\n              (node._payload.value._store.validated = 1)\n            : node._store && (node._store.validated = 1));\n    }\n    function isValidElement(object) {\n      return (\n        \"object\" === typeof object &&\n        null !== object &&\n        object.$$typeof === REACT_ELEMENT_TYPE\n      );\n    }\n    var React = require(\"react\"),\n      REACT_ELEMENT_TYPE = Symbol.for(\"react.transitional.element\"),\n      REACT_PORTAL_TYPE = Symbol.for(\"react.portal\"),\n      REACT_FRAGMENT_TYPE = Symbol.for(\"react.fragment\"),\n      REACT_STRICT_MODE_TYPE = Symbol.for(\"react.strict_mode\"),\n      REACT_PROFILER_TYPE = Symbol.for(\"react.profiler\"),\n      REACT_CONSUMER_TYPE = Symbol.for(\"react.consumer\"),\n      REACT_CONTEXT_TYPE = Symbol.for(\"react.context\"),\n      REACT_FORWARD_REF_TYPE = Symbol.for(\"react.forward_ref\"),\n      REACT_SUSPENSE_TYPE = Symbol.for(\"react.suspense\"),\n      REACT_SUSPENSE_LIST_TYPE = Symbol.for(\"react.suspense_list\"),\n      REACT_MEMO_TYPE = Symbol.for(\"react.memo\"),\n      REACT_LAZY_TYPE = Symbol.for(\"react.lazy\"),\n      REACT_ACTIVITY_TYPE = Symbol.for(\"react.activity\"),\n      REACT_CLIENT_REFERENCE = Symbol.for(\"react.client.reference\"),\n      ReactSharedInternals =\n        React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,\n      hasOwnProperty = Object.prototype.hasOwnProperty,\n      isArrayImpl = Array.isArray,\n      createTask = console.createTask\n        ? console.createTask\n        : function () {\n            return null;\n          };\n    React = {\n      react_stack_bottom_frame: function (callStackForError) {\n        return callStackForError();\n      }\n    };\n    var specialPropKeyWarningShown;\n    var didWarnAboutElementRef = {};\n    var unknownOwnerDebugStack = React.react_stack_bottom_frame.bind(\n      React,\n      UnknownOwner\n    )();\n    var unknownOwnerDebugTask = createTask(getTaskName(UnknownOwner));\n    var didWarnAboutKeySpread = {};\n    exports.Fragment = REACT_FRAGMENT_TYPE;\n    exports.jsx = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !1,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n    exports.jsxs = function (type, config, maybeKey) {\n      var trackActualOwner =\n        1e4 > ReactSharedInternals.recentlyCreatedOwnerStacks++;\n      return jsxDEVImpl(\n        type,\n        config,\n        maybeKey,\n        !0,\n        trackActualOwner\n          ? Error(\"react-stack-top-frame\")\n          : unknownOwnerDebugStack,\n        trackActualOwner ? createTask(getTaskName(type)) : unknownOwnerDebugTask\n      );\n    };\n  })();\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const api = { setState, getState, getInitialState, subscribe };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = ((createState) => createState ? createStoreImpl(createState) : createStoreImpl);\n\nexport { createStore };\n","import React from 'react';\nimport { createStore } from 'zustand/vanilla';\n\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity) {\n  const slice = React.useSyncExternalStore(\n    api.subscribe,\n    React.useCallback(() => selector(api.getState()), [api, selector]),\n    React.useCallback(() => selector(api.getInitialState()), [api, selector])\n  );\n  React.useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  const api = createStore(createState);\n  const useBoundStore = (selector) => useStore(api, selector);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = ((createState) => createState ? createImpl(createState) : createImpl);\n\nexport { create, useStore };\n","/**\n * Zustand store for book state management\n */\nimport { create } from 'zustand';\nimport { BookConfig, BookDimensions } from '../types/book';\n\n// Animation helper - simple easing for smooth transitions\nconst animateValue = (\n  from: number,\n  to: number,\n  duration: number,\n  setter: (value: number) => void,\n  easing: (t: number) => number = (t) => t // Linear by default\n) => {\n  const startTime = performance.now();\n\n  const animate = (currentTime: number) => {\n    const elapsed = currentTime - startTime;\n    const progress = Math.min(elapsed / duration, 1);\n    const easedProgress = easing(progress);\n    const value = from + (to - from) * easedProgress;\n\n    setter(value);\n\n    if (progress < 1) {\n      requestAnimationFrame(animate);\n    }\n  };\n\n  requestAnimationFrame(animate);\n};\n\n// Easing functions\nconst easeInOutCubic = (t: number) => {\n  return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;\n};\n\nconst easeOutElastic = (t: number) => {\n  const c4 = (2 * Math.PI) / 3;\n  return t === 0 ? 0 : t === 1 ? 1 : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;\n};\n\ninterface BookState extends BookConfig {\n  // Direct state setters\n  setPageCount: (count: number) => void;\n  setCurrentPage: (page: number) => void;\n  flipPage: (direction: 'forward' | 'backward') => void;\n  toggleContinuousFlip: (direction: 'forward' | 'backward') => void;\n  setDimensions: (dimensions: Partial<BookDimensions>) => void;\n  setSpineRotation: (rotation: number) => void;\n  setTilt: (tilt: number) => void;\n  setScale: (scale: number) => void;\n  setPosition: (position: [number, number, number]) => void;\n  setFrontHinge: (hinge: number) => void;\n  setBackHinge: (hinge: number) => void;\n  setBothHinges: (hinge: number) => void;\n  setPageOpacity: (opacity: number) => void;\n  setPageColor: (color: string) => void;\n  setGlowIntensity: (intensity: number) => void;\n  setCoverColor: (color: string) => void;\n  setCoverOpacity: (opacity: number) => void;\n  setFrontCoverText: (text: string) => void;\n  setBackCoverText: (text: string) => void;\n  setCoverTextColor: (color: string) => void;\n  setFontFamily: (font: string) => void;\n  setParticlesEnabled: (enabled: boolean) => void;\n  setParticleIntensity: (intensity: number) => void;\n  setConfidenceScore: (score: number) => void;\n  setDebug: (debug: boolean) => void;\n  setTestPageFlipAngle: (angle: number) => void;\n  reset: () => void;\n\n  // Animated actions\n  openBook: (duration?: number) => void;\n  closeBook: (duration?: number) => void;\n  flipPages: (count: number, direction: 'forward' | 'backward', duration?: number) => void;\n  triggerEmotion: (emotion: 'focus' | 'drift' | 'paradox') => void;\n  morphMaterial: (material: 'leather' | 'metal' | 'glass') => void;\n}\n\nconst initialState: BookConfig = {\n  // Core settings\n  pageCount: 30, // More pages for better visual\n  currentPage: 15, // Open in the middle\n  dimensions: {\n    height: 4,\n    width: 3,\n    depth: 0.6, // Will be calculated from pageCount\n  },\n\n  // Transformations\n  spineRotation: 0.5,\n  tilt: 0.2,\n  scale: 1,\n  position: [0, 0, 0] as [number, number, number],\n\n  // Cover hinges\n  frontHinge: 0,\n  backHinge: 0,\n\n  // Appearance\n  pageOpacity: 0.15,\n  pageColor: '#00ffcc',\n  glowIntensity: 0,\n  coverColor: '#2b1e16',\n  coverOpacity: 1,\n  spineColor: '#1a0f0a',\n\n  // Cover text\n  frontCoverText: '',\n  backCoverText: '',\n  coverTextColor: '#c9a876',\n  coverOutlineColor: '#c9a876',\n  coverOutlineWidth: 3,\n  fontFamily: 'Roboto',\n\n  // Features\n  particlesEnabled: true,\n  particleIntensity: 0.5,\n  confidenceScore: 0,\n\n  // Debug\n  debug: false,\n  testPageFlipAngle: 0, // 0 = back cover, 180 = front cover\n\n  // Page flip animation\n  flippingPageIndex: null,\n  flipProgress: 0,\n  flipDirection: null,\n  isFlippingContinuously: false,\n  continuousDirection: null,\n};\n\n// ... types remain the same, just exporting the creator function now\nexport type BookStore = ReturnType<typeof createBookStore>;\n\nexport const createBookStore = (initProps?: Partial<BookConfig>) => {\n  const DEFAULT_PROPS: BookConfig = { ...initialState, ...initProps };\n\n  return create<BookState>((set, get) => ({\n    ...DEFAULT_PROPS,\n\n    // Actions\n    setPageCount: (count) => {\n      const validCount = Math.max(10, Math.min(100, count)); // 10-100 pages (density)\n      const currentPage = Math.floor(validCount / 2); // Keep in middle\n\n      // Spine depth is FIXED (0.6) - pages are density within that space\n      // More pages = denser packing, not thicker spine\n      const spineDepth = 0.6;\n\n      set({\n        pageCount: validCount,\n        currentPage: currentPage,\n        dimensions: {\n          ...get().dimensions,\n          depth: spineDepth\n        }\n      });\n    },\n\n    setCurrentPage: (page) => {\n      const { pageCount } = get();\n      // Keep within bounds, but allow wrapping\n      const validPage = ((page % pageCount) + pageCount) % pageCount;\n      set({ currentPage: validPage });\n    },\n\n    flipPage: (direction) => {\n      const state = get();\n      const { currentPage, pageCount, flippingPageIndex, isFlippingContinuously } = state;\n\n      // Don't start new flip if one is in progress\n      if (flippingPageIndex !== null) {\n        console.log('âš ï¸ Flip already in progress');\n        return;\n      }\n\n      if (direction === 'forward') {\n        // Flip forward (increase current page)\n        const newPage = Math.min(currentPage + 1, pageCount - 1);\n        if (newPage === currentPage) {\n          console.log('âš ï¸ Already at last page');\n          return;\n        }\n\n        console.log('ðŸ“„ Start flip forward:', currentPage, 'â†’', newPage);\n\n        // Start animation - DON'T update currentPage yet\n        set({ flippingPageIndex: currentPage, flipProgress: 0, flipDirection: 'forward' });\n\n        // Animate flip progress\n        const duration = 500; // ms\n        const startTime = performance.now();\n\n        const animate = (currentTime: number) => {\n          const elapsed = currentTime - startTime;\n          const progress = Math.min(elapsed / duration, 1);\n\n          set({ flipProgress: progress });\n          console.log(`  Progress: ${(progress * 100).toFixed(1)}%`);\n\n          if (progress < 1) {\n            requestAnimationFrame(animate);\n          } else {\n            // Animation complete - reset without updating currentPage\n            set({ flippingPageIndex: null, flipProgress: 0, flipDirection: null });\n            console.log('âœ… Flip animation complete (currentPage unchanged)');\n\n            // If continuous flip is on, start next flip\n            if (get().isFlippingContinuously && get().continuousDirection === 'forward') {\n              setTimeout(() => {\n                if (get().isFlippingContinuously && get().continuousDirection === 'forward') {\n                  get().flipPage('forward');\n                }\n              }, 100);\n            }\n          }\n        };\n\n        requestAnimationFrame(animate);\n\n      } else {\n        // Flip backward (decrease current page)\n        const newPage = Math.max(currentPage - 1, 0);\n        if (newPage === currentPage) {\n          console.log('âš ï¸ Already at first page');\n          return;\n        }\n\n        console.log('ðŸ“„ Start flip BACKWARD:', currentPage, 'â†’', newPage);\n        console.log('   Flipping page', currentPage, 'from FRONT to BACK');\n\n        // For backward, flip the first page from the FRONT stack\n        // This is the page at index currentPage\n        set({ flippingPageIndex: currentPage, flipProgress: 0, flipDirection: 'backward' });\n\n        // Animate flip progress (in reverse - front to back)\n        const duration = 500; // ms\n        const startTime = performance.now();\n\n        const animate = (currentTime: number) => {\n          const elapsed = currentTime - startTime;\n          const progress = Math.min(elapsed / duration, 1);\n\n          set({ flipProgress: progress });\n          console.log(`  Progress: ${(progress * 100).toFixed(1)}% (BACKWARD)`);\n\n          if (progress < 1) {\n            requestAnimationFrame(animate);\n          } else {\n            // Animation complete - reset without updating currentPage\n            set({ flippingPageIndex: null, flipProgress: 0, flipDirection: null });\n            console.log('âœ… Flip animation complete (currentPage unchanged)');\n\n            // If continuous flip is on, start next flip\n            if (get().isFlippingContinuously && get().continuousDirection === 'backward') {\n              setTimeout(() => {\n                if (get().isFlippingContinuously && get().continuousDirection === 'backward') {\n                  get().flipPage('backward');\n                }\n              }, 100);\n            }\n          }\n        };\n\n        requestAnimationFrame(animate);\n      }\n    },\n\n    toggleContinuousFlip: (direction) => {\n      const state = get();\n      const { isFlippingContinuously, continuousDirection } = state;\n\n      if (isFlippingContinuously && continuousDirection === direction) {\n        // Toggle off\n        console.log('â¸ï¸ Stop continuous flip');\n        set({ isFlippingContinuously: false, continuousDirection: null });\n      } else {\n        // Toggle on (and turn off opposite direction)\n        console.log('â–¶ï¸ Start continuous flip', direction);\n        set({ isFlippingContinuously: true, continuousDirection: direction });\n\n        // Start the first flip\n        get().flipPage(direction);\n      }\n    },\n\n    setDimensions: (dims) => {\n      const current = get().dimensions;\n      const newDimensions = { ...current, ...dims };\n\n      // If depth is manually changed, update page count to match\n      if (dims.depth !== undefined && dims.depth !== current.depth) {\n        const estimatedPageCount = Math.round(dims.depth / 0.002);\n        const validCount = Math.max(10, Math.min(100, estimatedPageCount));\n        set({\n          dimensions: newDimensions,\n          pageCount: validCount,\n          currentPage: Math.floor(validCount / 2)\n        });\n      } else {\n        set({ dimensions: newDimensions });\n      }\n    },\n\n    setSpineRotation: (rotation) => set({ spineRotation: rotation }),\n    setTilt: (tilt) => set({ tilt: tilt }),\n    setScale: (scale) => set({ scale: scale }),\n    setPosition: (position) => set({ position: position }),\n    setFrontHinge: (hinge) => set({ frontHinge: hinge }),\n    setBackHinge: (hinge) => set({ backHinge: hinge }),\n    setBothHinges: (hinge) => set({ frontHinge: hinge, backHinge: hinge }),\n    setPageOpacity: (opacity) => set({ pageOpacity: opacity }),\n    setPageColor: (color) => set({ pageColor: color }),\n    setGlowIntensity: (intensity) => set({ glowIntensity: intensity }),\n    setCoverColor: (color) => set({ coverColor: color }),\n    setCoverOpacity: (opacity) => set({ coverOpacity: opacity }),\n    setSpineColor: (color) => set({ spineColor: color }),\n    setFrontCoverText: (text) => set({ frontCoverText: text }),\n    setBackCoverText: (text) => set({ backCoverText: text }),\n    setCoverTextColor: (color) => set({ coverTextColor: color }),\n    setCoverOutlineColor: (color) => set({ coverOutlineColor: color }),\n    setCoverOutlineWidth: (width) => set({ coverOutlineWidth: width }),\n    setFontFamily: (font) => set({ fontFamily: font }),\n    setParticlesEnabled: (enabled) => set({ particlesEnabled: enabled }),\n    setParticleIntensity: (intensity) => set({ particleIntensity: intensity }),\n    setConfidenceScore: (score) => set({ confidenceScore: score }),\n    setDebug: (debug) => set({ debug: debug }),\n    setTestPageFlipAngle: (angle) => {\n      set({ testPageFlipAngle: angle });\n      console.log('ðŸ“„ Test page flip angle:', angle.toFixed(1), 'Â°');\n    },\n    reset: () => set(initialState),\n\n    // ========== ANIMATED ACTIONS ==========\n\n    /**\n     * Open book - smoothly animate both covers to open position\n     */\n    openBook: (duration = 1000) => {\n      const current = get();\n      const targetAngle = Math.PI * 0.4; // ~72 degrees (realistic book open angle)\n\n      animateValue(\n        current.frontHinge,\n        targetAngle,\n        duration,\n        (value) => set({ frontHinge: value }),\n        easeInOutCubic\n      );\n\n      animateValue(\n        current.backHinge,\n        targetAngle,\n        duration,\n        (value) => set({ backHinge: value }),\n        easeInOutCubic\n      );\n\n      // Increase particle intensity when opening\n      animateValue(\n        current.particleIntensity,\n        0.7,\n        duration,\n        (value) => set({ particleIntensity: value }),\n        easeInOutCubic\n      );\n    },\n\n    /**\n     * Close book - smoothly animate both covers to closed position\n     */\n    closeBook: (duration = 1000) => {\n      const current = get();\n\n      animateValue(\n        current.frontHinge,\n        0,\n        duration,\n        (value) => set({ frontHinge: value }),\n        easeInOutCubic\n      );\n\n      animateValue(\n        current.backHinge,\n        0,\n        duration,\n        (value) => set({ backHinge: value }),\n        easeInOutCubic\n      );\n\n      // Decrease particle intensity when closing\n      animateValue(\n        current.particleIntensity,\n        0,\n        duration,\n        (value) => set({ particleIntensity: value }),\n        easeInOutCubic\n      );\n\n      // Reset glow\n      animateValue(\n        current.glowIntensity,\n        0,\n        duration,\n        (value) => set({ glowIntensity: value }),\n        easeInOutCubic\n      );\n    },\n\n    /**\n     * Flip multiple pages with animation (visual flip for each)\n     */\n    flipPages: (count, direction, duration = 200) => {\n      const state = get();\n      const { flippingPageIndex } = state;\n\n      // Don't start if already flipping\n      if (flippingPageIndex !== null) {\n        console.log('âš ï¸ Flip already in progress');\n        return;\n      }\n\n      let flipped = 0;\n\n      const flipNext = () => {\n        if (flipped >= count) {\n          console.log('âœ… Finished flipping', count, 'pages', direction);\n          return;\n        }\n\n        // Get fresh state\n        const state = get();\n        const { currentPage, pageCount } = state;\n\n        let newPage: number;\n\n        if (direction === 'forward') {\n          newPage = Math.min(currentPage + 1, pageCount - 1);\n        } else {\n          newPage = Math.max(currentPage - 1, 0);\n        }\n\n        if (newPage === currentPage) {\n          console.log('âš ï¸ Reached boundary at page', currentPage);\n          return;\n        }\n\n        console.log(`ðŸ“„ Flip ${flipped + 1}/${count}: page ${currentPage} â†’ ${newPage}`);\n\n        // Start visual flip animation for this page\n        const pageToFlip = direction === 'forward' ? currentPage : currentPage;\n        set({ flippingPageIndex: pageToFlip, flipProgress: 0 });\n\n        // Animate this page flip\n        const flipDuration = 500; // Each page flips in 500ms\n        const startTime = performance.now();\n\n        const animate = (currentTime: number) => {\n          const elapsed = currentTime - startTime;\n          const progress = Math.min(elapsed / flipDuration, 1);\n\n          set({ flipProgress: progress });\n\n          if (progress < 1) {\n            requestAnimationFrame(animate);\n          } else {\n            // This page flip complete - reset without updating currentPage\n            set({ flippingPageIndex: null, flipProgress: 0, flipDirection: null });\n            flipped++;\n\n            // Start next flip after a brief pause\n            if (flipped < count) {\n              setTimeout(flipNext, 50); // 50ms pause between flips\n            } else {\n              console.log('âœ… All', count, 'page animations complete (currentPage unchanged)');\n            }\n          }\n        };\n\n        requestAnimationFrame(animate);\n      };\n\n      console.log('â–¶ï¸ Starting', count, 'page flips', direction, 'from page', get().currentPage);\n      flipNext();\n    },\n\n    /**\n     * Trigger emotional states (from README concept)\n     */\n    triggerEmotion: (emotion) => {\n      const current = get();\n\n      switch (emotion) {\n        case 'focus':\n          // Bright pulsing of pages (high confidence, active thinking)\n          // Slow, bright pulses (same frequency as drift)\n          let pulseCycles = 0;\n          const maxPulses = 5;\n          const pulseDuration = 1200; // Same slow duration as drift\n\n          const pulse = () => {\n            if (pulseCycles >= maxPulses) {\n              // End with bright glow\n              animateValue(get().glowIntensity, 1.2, pulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n              return;\n            }\n\n            // Up to bright\n            animateValue(get().glowIntensity, 1.8, pulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n\n            setTimeout(() => {\n              // Down\n              animateValue(get().glowIntensity, 0.8, pulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n              pulseCycles++;\n              setTimeout(pulse, pulseDuration / 2);\n            }, pulseDuration / 2);\n          };\n\n          pulse();\n\n          // Increase particle flow\n          animateValue(current.particleIntensity, 1.0, 800, (v) => set({ particleIntensity: v }), easeInOutCubic);\n          break;\n\n        case 'drift':\n          // Dimming pulsing of pages (daydreaming, low activity)\n          // Slow, dim pulses (same frequency as focus)\n          let dimPulseCycles = 0;\n          const maxDimPulses = 5;\n          const dimPulseDuration = 1200; // Same slow duration as focus\n\n          const dimPulse = () => {\n            if (dimPulseCycles >= maxDimPulses) {\n              // End very dim\n              animateValue(get().glowIntensity, 0.1, dimPulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n              return;\n            }\n\n            // Slightly up\n            animateValue(get().glowIntensity, 0.4, dimPulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n\n            setTimeout(() => {\n              // Down to dim\n              animateValue(get().glowIntensity, 0.1, dimPulseDuration / 2, (v) => set({ glowIntensity: v }), easeInOutCubic);\n              dimPulseCycles++;\n              setTimeout(dimPulse, dimPulseDuration / 2);\n            }, dimPulseDuration / 2);\n          };\n\n          dimPulse();\n\n          // Decrease particles\n          animateValue(current.particleIntensity, 0.1, 1200, (v) => set({ particleIntensity: v }), easeInOutCubic);\n          break;\n\n        case 'paradox':\n          // Violent tremor effect - rapid position shake\n          const originalRotation = current.spineRotation;\n          const originalTilt = current.tilt;\n          const shakeIntensity = 0.15;\n          const shakeCount = 10;\n          const shakeDuration = 50;\n\n          let shakes = 0;\n          const shake = () => {\n            if (shakes >= shakeCount) {\n              // Return to original position\n              set({ spineRotation: originalRotation, tilt: originalTilt });\n              return;\n            }\n\n            const randomRotation = originalRotation + (Math.random() - 0.5) * shakeIntensity;\n            const randomTilt = originalTilt + (Math.random() - 0.5) * shakeIntensity;\n            set({ spineRotation: randomRotation, tilt: randomTilt });\n\n            shakes++;\n            setTimeout(shake, shakeDuration);\n          };\n\n          shake();\n\n          // Flash glow\n          animateValue(current.glowIntensity, 2.0, 200, (v) => set({ glowIntensity: v }));\n          setTimeout(() => {\n            animateValue(2.0, 0.3, 300, (v) => set({ glowIntensity: v }));\n          }, 200);\n          break;\n      }\n    },\n\n    /**\n     * Morph cover material appearance (from README concept)\n     */\n    morphMaterial: (material) => {\n      const current = get();\n\n      switch (material) {\n        case 'leather':\n          // Dark, matte, organic - humanities/lore\n          set({ coverColor: '#2b1e16', coverOpacity: 1.0 });\n          animateValue(current.glowIntensity, 0.1, 500, (v) => set({ glowIntensity: v }), easeInOutCubic);\n          break;\n\n        case 'metal':\n          // Reflective, cold, hard - scientific/logical\n          set({ coverColor: '#556b7d', coverOpacity: 1.0 });\n          animateValue(current.glowIntensity, 0.8, 500, (v) => set({ glowIntensity: v }), easeInOutCubic);\n          animateValue(current.particleIntensity, 0.9, 500, (v) => set({ particleIntensity: v }), easeInOutCubic);\n          break;\n\n        case 'glass':\n          // Transparent, vulnerable - ultimate truth\n          set({ coverColor: '#d0e8f2', coverOpacity: 0.3 });\n          animateValue(current.glowIntensity, 1.8, 500, (v) => set({ glowIntensity: v }), easeInOutCubic);\n          animateValue(current.particleIntensity, 1.0, 500, (v) => set({ particleIntensity: v }), easeInOutCubic);\n          break;\n      }\n    },\n  }));\n};\n","/**\n * Context Provider for Book Store\n * Should be wrapped around the Book component to provide isolated state\n */\nimport { createContext, useContext, useRef } from 'react';\nimport { useStore } from 'zustand';\nimport { createBookStore, BookStore } from '../../stores/bookStore';\nimport { BookConfig } from '../../types/book';\n\n// Create Context\nconst BookContext = createContext<BookStore | null>(null);\n\ninterface BookProviderProps extends Partial<BookConfig> {\n    children: React.ReactNode;\n}\n\n/**\n * Provider component that initializes a new store instance\n */\nexport function BookProvider({ children, ...props }: BookProviderProps) {\n    const storeRef = useRef<BookStore>();\n\n    // Initialize store once\n    if (!storeRef.current) {\n        storeRef.current = createBookStore(props);\n    }\n\n    return (\n        <BookContext.Provider value={storeRef.current}>\n            {children}\n        </BookContext.Provider>\n    );\n}\n\n/**\n * Hook to consume the book store from context\n * Throws error if used outside of provider\n */\nexport function useBookStore<T>(selector: (state: any) => T): T {\n    const store = useContext(BookContext);\n\n    if (!store) {\n        throw new Error('useBookStore must be used within a BookProvider');\n    }\n\n    return useStore(store, selector);\n}\n\n// Re-export specific store actions/selectors hook for convenience if needed\n// or users can just use useBookStore(state => state.something)\n","/**\n * Individual Page Component\n * Pages positioned INSIDE the book between covers\n */\nimport * as THREE from 'three';\nimport { PageProps } from '../../types/book';\n\nexport function Page({ \n  index,\n  totalPages,\n  currentPage,\n  opacity = 0.15, \n  color = '#00ffcc',\n  glow = 0,\n  coverWidth,\n  coverHeight\n}: PageProps) {\n  // Page dimensions - slightly smaller than covers to fit inside\n  const pageWidth = coverWidth * 0.93;\n  const pageHeight = coverHeight * 0.95;\n  \n  // Spine parameters\n  const spineWidth = 0.1;\n  const spineDepth = 0.6;\n  \n  // Determine which cover this page is attached to\n  const isAttachedToBack = index < currentPage;\n  \n  // Spread pages across the spine depth\n  // Parent group is at inside face of cover (offset by coverThickness/2)\n  // Pages spread from inside face (z=0) toward the center of the book\n  \n  const coverThickness = 0.05;\n  // Available depth to spread pages (from inside face to center)\n  const availableDepth = spineDepth / 2 - coverThickness / 2;\n  \n  let zOffset: number;\n  \n  if (isAttachedToBack && currentPage > 0) {\n    // Back pages: spread from inside face (0) toward center (positive Z)\n    // Back cover is at z=-0.3, inside face at -0.275, center at 0\n    const progress = index / (currentPage - 1 || 1);\n    zOffset = progress * availableDepth; // Positive spreads toward center (0)\n  } else {\n    // Front pages: spread from inside face (0) toward center (negative Z)\n    // Front cover is at z=+0.3, inside face at +0.275, center at 0\n    const progress = (index - currentPage) / (totalPages - currentPage - 1 || 1);\n    zOffset = -progress * availableDepth; // Negative spreads toward center (0)\n  }\n  \n  return (\n    <group position={[0, 0, zOffset]}>\n      {/* Page mesh positioned so it stays inside cover bounds */}\n      <mesh position={[pageWidth / 2, 0, 0]}>\n        <planeGeometry args={[pageWidth, pageHeight]} />\n        <meshStandardMaterial\n          color={color}\n          transparent\n          opacity={opacity}\n          side={THREE.DoubleSide}\n          emissive={color}\n          emissiveIntensity={glow}\n          depthWrite={false}\n        />\n      </mesh>\n    </group>\n  );\n}\n","/**\n * Custom hook for creating cover textures from text\n */\nimport { useMemo } from 'react';\nimport * as THREE from 'three';\n\nexport function useCoverTexture(\n  text: string | undefined,\n  textColor: string = '#c9a876',\n  outlineColor: string = '#c9a876',\n  outlineWidth: number = 3,\n  isFront: boolean = true,\n  fontFamily: string = 'Roboto'\n) {\n  return useMemo(() => {\n    // SSR check\n    if (typeof document === 'undefined') return null;\n\n    if (!text) return null;\n\n    // Create canvas for texture\n    const canvas = document.createElement('canvas');\n    canvas.width = 512;\n    canvas.height = 512;\n    const ctx = canvas.getContext('2d');\n\n    if (!ctx) return null;\n\n    // Completely transparent background - only text will be visible\n    ctx.clearRect(0, 0, 512, 512);\n\n    // Setup text style\n    ctx.fillStyle = textColor;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n\n    // Handle multi-line text\n    const lines = text.split('\\n');\n    const fontSize = Math.min(48, Math.floor(400 / lines.length));\n    ctx.font = `bold ${fontSize}px ${fontFamily}, sans-serif`;\n\n    // Draw text lines\n    const startY = 256 - ((lines.length - 1) * (fontSize + 10)) / 2;\n    lines.forEach((line, i) => {\n      const y = startY + i * (fontSize + 10);\n\n      // Word wrap for long lines\n      const words = line.split(' ');\n      const maxWidth = 450;\n      let currentLine = '';\n      let currentY = y;\n\n      words.forEach((word, wordIndex) => {\n        const testLine = currentLine + (currentLine ? ' ' : '') + word;\n        const metrics = ctx.measureText(testLine);\n\n        if (metrics.width > maxWidth && currentLine) {\n          ctx.fillText(currentLine, 256, currentY);\n          currentLine = word;\n          currentY += fontSize + 5;\n        } else {\n          currentLine = testLine;\n        }\n\n        // Last word\n        if (wordIndex === words.length - 1) {\n          ctx.fillText(currentLine, 256, currentY);\n        }\n      });\n    });\n\n    // No decorative border - just text floating\n\n    // Create texture\n    const texture = new THREE.CanvasTexture(canvas);\n    texture.needsUpdate = true;\n\n    return texture;\n  }, [text, textColor, outlineColor, outlineWidth, isFront, fontFamily]);\n}\n\n","/**\n * Cover Component\n * Hinged book cover that opens/closes from spine edge\n */\nimport * as THREE from 'three';\nimport { CoverProps } from '../../types/book';\nimport { useCoverTexture } from '../../hooks/useCoverTexture';\n\nexport function Cover({\n  side,\n  width,\n  height,\n  hinge,\n  text,\n  textColor = '#c9a876',\n  outlineColor = '#c9a876',\n  outlineWidth = 3,\n  color = '#2b1e16',\n  opacity = 1,\n  fontFamily = 'Roboto'\n}: CoverProps & { fontFamily?: string }) {\n  const texture = useCoverTexture(text, textColor, outlineColor, outlineWidth, side === 'front', fontFamily);\n\n  // Cover pivots at spine edge\n  // Spine is centered at origin with width 0.1\n  // Spine goes from -0.05 to +0.05 in X\n  // Front cover pivots at RIGHT edge of spine (x = 0.05)\n  // Position in Z based on spine depth (0.6 total, so Â±0.3)\n  const spineWidth = 0.1;\n  const spineDepth = 0.6;\n  const coverThickness = 0.05;\n\n  const pivotX = spineWidth / 2; // 0.05\n  const pivotZ = side === 'front' ? spineDepth / 2 : -spineDepth / 2; // Â±0.3\n\n  // Rotation direction: front cover uses negative (opens forward), back uses positive\n  const hingeRotation = side === 'front' ? -hinge : hinge;\n\n  return (\n    <group\n      position={[pivotX, 0, pivotZ]}\n      rotation={[0, hingeRotation, 0]}\n    >\n      {/* Cover box - plain color only */}\n      <mesh\n        position={[width / 2, 0, 0]}\n        castShadow\n        receiveShadow\n      >\n        <boxGeometry args={[width, height, coverThickness]} />\n        <meshStandardMaterial\n          color={color}\n          transparent={opacity < 1}\n          opacity={opacity}\n          side={THREE.DoubleSide}\n        />\n      </mesh>\n\n      {/* Floating text centered on cover, offset outward from pages */}\n      {texture && (\n        <mesh\n          position={[\n            width / 2,\n            0,\n            side === 'front'\n              ? coverThickness / 2 + 0.01   // Front: offset in +Z (away from pages)\n              : -(coverThickness / 2 + 0.01) // Back: offset in -Z (away from pages)\n          ]}\n          rotation={[\n            0,\n            side === 'back' ? Math.PI : 0, // Back cover: flip 180Â° around Y axis\n            0\n          ]}\n        >\n          <planeGeometry args={[width * 0.9, height * 0.9]} />\n          <meshStandardMaterial\n            map={texture}\n            transparent={true}\n            opacity={1.0} // Text always fully opaque, independent of cover opacity\n            side={THREE.DoubleSide} // Visible from both sides\n            depthWrite={false}\n            alphaTest={0.1} // Only render non-transparent parts\n          />\n        </mesh>\n      )}\n    </group>\n  );\n}\n\n","/**\n * Spine Component\n * The central axis of the book - fixed depth, pages are density\n */\nimport { SpineProps } from '../../types/book';\n\nexport function Spine({ \n  width = 0.1, \n  height = 4, \n  depth = 0.6,\n  color = '#666666',\n  pageCount = 30\n}: SpineProps) {\n  // Spine depth is FIXED - doesn't change with page count\n  // Page count represents DENSITY (how tightly packed pages are)\n  \n  return (\n    <mesh position={[0, 0, 0]}>\n      <boxGeometry args={[width, height, depth]} />\n      <meshStandardMaterial color={color} />\n    </mesh>\n  );\n}\n","/**\n * Particle System Component\n * Animated particles flowing around the book\n */\nimport { useRef, useMemo } from 'react';\nimport { useFrame } from '@react-three/fiber';\nimport * as THREE from 'three';\nimport { ParticleProps } from '../../types/book';\n\nexport function Particles({ \n  count = 200, \n  intensity, \n  enabled,\n  bookDimensions \n}: ParticleProps) {\n  const pointsRef = useRef<THREE.Points>(null);\n  \n  // Create particle geometry and velocities\n  const { positions, velocities } = useMemo(() => {\n    const positions = new Float32Array(count * 3);\n    const velocities = new Float32Array(count * 3);\n    \n    const { height, width, depth } = bookDimensions;\n    \n    // Initialize particles emanating from page area toward the front\n    for (let i = 0; i < count; i++) {\n      const i3 = i * 3;\n      \n      // Start particles from page area (near spine, within book depth)\n      positions[i3] = (Math.random() - 0.5) * width * 0.5; // Near center (spine area)\n      positions[i3 + 1] = (Math.random() - 0.5) * height; // Full height\n      positions[i3 + 2] = (Math.random() - 0.5) * depth; // Within spine depth\n      \n      // Velocities: flow forward (positive X), slightly upward and outward\n      velocities[i3] = 0.01 + Math.random() * 0.02; // Forward (toward front of book)\n      velocities[i3 + 1] = Math.random() * 0.01; // Slightly upward\n      velocities[i3 + 2] = (Math.random() - 0.5) * 0.005; // Slight Z spread\n    }\n    \n    return { positions, velocities };\n  }, [count, bookDimensions]);\n  \n  // Animate particles\n  useFrame((state, delta) => {\n    if (!pointsRef.current || !enabled) return;\n    \n    const geometry = pointsRef.current.geometry;\n    const positionAttr = geometry.attributes.position;\n    const { height, width, depth } = bookDimensions;\n    \n    for (let i = 0; i < count; i++) {\n      const i3 = i * 3;\n      \n      // Update positions - particles flow forward\n      positionAttr.array[i3] += velocities[i3] * intensity; // Speed affected by intensity\n      positionAttr.array[i3 + 1] += velocities[i3 + 1] * intensity;\n      positionAttr.array[i3 + 2] += velocities[i3 + 2] * intensity;\n      \n      // Respawn at page source when particle moves too far forward\n      if (positionAttr.array[i3] > width * 2) {\n        // Respawn at page area\n        positionAttr.array[i3] = (Math.random() - 0.5) * width * 0.5; // Near spine\n        positionAttr.array[i3 + 1] = (Math.random() - 0.5) * height;\n        positionAttr.array[i3 + 2] = (Math.random() - 0.5) * depth;\n      }\n      \n      // Wrap Y and Z\n      if (Math.abs(positionAttr.array[i3 + 1]) > height * 1.5) {\n        positionAttr.array[i3 + 1] = (Math.random() - 0.5) * height;\n      }\n      if (Math.abs(positionAttr.array[i3 + 2]) > depth * 1.5) {\n        positionAttr.array[i3 + 2] = (Math.random() - 0.5) * depth;\n      }\n    }\n    \n    positionAttr.needsUpdate = true;\n  });\n  \n  if (!enabled) return null;\n  \n  const effectiveIntensity = Math.max(0.05, intensity);\n  \n  return (\n    <points ref={pointsRef}>\n      <bufferGeometry>\n        <bufferAttribute\n          attach=\"attributes-position\"\n          count={count}\n          array={positions}\n          itemSize={3}\n        />\n      </bufferGeometry>\n      <pointsMaterial\n        size={0.05 * effectiveIntensity}\n        color=\"#00ffcc\"\n        transparent\n        opacity={effectiveIntensity}\n        sizeAttenuation\n        blending={THREE.AdditiveBlending}\n      />\n    </points>\n  );\n}\n\n","/**\n * Main Book Component\n * Composes all book parts with proper physics\n */\nimport { useRef } from 'react';\nimport * as THREE from 'three';\nimport { Group } from 'three';\nimport { useFrame } from '@react-three/fiber';\nimport { useBookStore } from './BookContext';\nimport { Page } from './Page';\nimport { Cover } from './Cover';\nimport { Spine } from './Spine';\nimport { Particles } from './Particles';\nimport { Html } from '@react-three/drei';\n\nexport function Book() {\n  const bookGroupRef = useRef<Group>(null);\n\n  // Get state from store\n  const {\n    pageCount,\n    currentPage,\n    dimensions,\n    spineRotation,\n    tilt,\n    scale,\n    position,\n    frontHinge,\n    backHinge,\n    pageOpacity,\n    pageColor,\n    glowIntensity,\n    coverColor,\n    coverOpacity,\n    spineColor,\n    frontCoverText,\n    backCoverText,\n    coverTextColor,\n    coverOutlineColor,\n    coverOutlineWidth,\n    particlesEnabled,\n    particleIntensity,\n    debug,\n    testPageFlipAngle,\n    flippingPageIndex,\n    flipProgress,\n    flipDirection,\n    fontFamily\n  } = useBookStore(state => state);\n\n  // Spine parameters - FIXED for proper book physics\n  const spineWidth = 0.1;\n  const spineDepth = 0.6;\n  const coverThickness = 0.05;\n\n  // Apply transformations to book group\n  useFrame(() => {\n    if (bookGroupRef.current) {\n      bookGroupRef.current.rotation.y = spineRotation;\n      bookGroupRef.current.rotation.z = tilt; // Tilt controls horizontality (lean left/right)\n      bookGroupRef.current.scale.setScalar(scale);\n      const safePosition = position || [0, 0, 0];\n      bookGroupRef.current.position.set(safePosition[0], safePosition[1], safePosition[2]);\n    }\n  });\n\n  return (\n    <group ref={bookGroupRef}>\n      {/* Debug helpers */}\n      {debug && (\n        <>\n          <axesHelper args={[2]} />\n          <gridHelper args={[10, 10]} />\n          <Html position={[0, dimensions.height / 2 + 0.5, 0]}>\n            <div style={{\n              background: 'rgba(0,0,0,0.8)',\n              color: '#00ffcc',\n              padding: '10px',\n              fontFamily: 'monospace',\n              fontSize: '10px',\n              borderRadius: '4px',\n              whiteSpace: 'nowrap'\n            }}>\n              <div>Total Pages: {pageCount}</div>\n              <div>Current Page: {currentPage}</div>\n              <div>Spine: {spineWidth} Ã— {spineDepth}</div>\n              <div>Back Pages: {currentPage}</div>\n              <div>Front Pages: {pageCount - currentPage}</div>\n              <div>Cover Width: {dimensions.width.toFixed(2)}</div>\n            </div>\n          </Html>\n        </>\n      )}\n\n      {/* Spine - centered at origin */}\n      <Spine\n        width={spineWidth}\n        height={dimensions.height}\n        depth={spineDepth}\n        color={spineColor}\n        pageCount={pageCount}\n      />\n\n      {/* Covers - pivot at spine edges */}\n      <Cover\n        side=\"front\"\n        width={dimensions.width}\n        height={dimensions.height}\n        hinge={frontHinge}\n        text={frontCoverText}\n        textColor={coverTextColor}\n        outlineColor={coverOutlineColor}\n        outlineWidth={coverOutlineWidth}\n        color={coverColor}\n        opacity={coverOpacity}\n        fontFamily={fontFamily}\n      />\n      <Cover\n        side=\"back\"\n        width={dimensions.width}\n        height={dimensions.height}\n        hinge={backHinge}\n        text={backCoverText}\n        textColor={coverTextColor}\n        outlineColor={coverOutlineColor}\n        outlineWidth={coverOutlineWidth}\n        color={coverColor}\n        opacity={coverOpacity}\n        fontFamily={fontFamily}\n      />\n\n      {/* Back cover pages - attached to INSIDE face of back cover */}\n      {/* Group at back cover pivot, pages extend inward (toward front) */}\n      <group\n        position={[spineWidth / 2, 0, -spineDepth / 2]}\n        rotation={[0, backHinge, 0]}\n      >\n        {/* Pages positioned at inside face of cover (toward the front) */}\n        <group position={[0, 0, coverThickness / 2]}>\n          {Array.from({ length: currentPage }, (_, i) => {\n            // Skip the page that's currently flipping forward\n            if (i === flippingPageIndex && flipProgress > 0) return null;\n\n            return (\n              <Page\n                key={`back-${i}`}\n                index={i}\n                totalPages={pageCount}\n                currentPage={currentPage}\n                opacity={pageOpacity}\n                color={pageColor}\n                glow={glowIntensity}\n                coverWidth={dimensions.width}\n                coverHeight={dimensions.height}\n              />\n            );\n          })}\n        </group>\n      </group>\n\n      {/* Front cover pages - attached to INSIDE face of front cover */}\n      {/* Group at front cover pivot, pages extend inward (toward back) */}\n      <group\n        position={[spineWidth / 2, 0, spineDepth / 2]}\n        rotation={[0, -frontHinge, 0]}\n      >\n        {/* Pages positioned at inside face of cover (toward the back) */}\n        <group position={[0, 0, -coverThickness / 2]}>\n          {Array.from({ length: pageCount - currentPage }, (_, i) => {\n            const pageIndex = i + currentPage;\n            // Skip the page that's currently flipping (when flipping backward)\n            if (pageIndex === flippingPageIndex && flipProgress > 0) return null;\n\n            return (\n              <Page\n                key={`front-${pageIndex}`}\n                index={pageIndex}\n                totalPages={pageCount}\n                currentPage={currentPage}\n                opacity={pageOpacity}\n                color={pageColor}\n                glow={glowIntensity}\n                coverWidth={dimensions.width}\n                coverHeight={dimensions.height}\n              />\n            );\n          })}\n        </group>\n      </group>\n\n      {/* Flipping page - rendered separately with animation */}\n      {flippingPageIndex !== null && flipProgress > 0 && (() => {\n        // Forward: Flip from FRONT to BACK (180 to 0)\n        // Backward: Flip from BACK to FRONT (0 to 180)\n        const pageRotation = flipDirection === 'forward'\n          ? -frontHinge + flipProgress * (backHinge - (-frontHinge))  // 180Â° â†’ 0Â°\n          : backHinge + flipProgress * (-frontHinge - backHinge);  // 0Â° â†’ 180Â°\n\n        return (\n          <group\n            position={[spineWidth / 2, 0, 0]}\n            rotation={[0, pageRotation, 0]}\n          >\n            {/* Flipping page with normal appearance */}\n            <mesh position={[dimensions.width * 0.93 / 2, 0, 0]}>\n              <planeGeometry args={[dimensions.width * 0.93, dimensions.height * 0.95]} />\n              <meshStandardMaterial\n                color={pageColor}\n                transparent\n                opacity={pageOpacity}\n                side={THREE.DoubleSide}\n                emissive={pageColor}\n                emissiveIntensity={glowIntensity}\n                depthWrite={false}\n              />\n            </mesh>\n          </group>\n        );\n      })()}\n\n      {/* Particles */}\n      <Particles\n        count={200}\n        intensity={particleIntensity}\n        enabled={particlesEnabled}\n        bookDimensions={{\n          ...dimensions,\n          depth: spineDepth\n        }}\n      />\n\n      {/* Debug: Manual test page that flips */}\n      {testPageFlipAngle > 0 && (() => {\n        // Calculate page rotation between the two cover angles\n        // 0Â° = back cover angle (backHinge)\n        // 180Â° = front cover angle (-frontHinge)\n        const progress = testPageFlipAngle / 180; // 0 to 1\n        const pageRotation = backHinge + progress * (-frontHinge - backHinge);\n\n        return (\n          <group\n            position={[spineWidth / 2, 0, 0]}\n            rotation={[0, pageRotation, 0]}\n          >\n            {/* Page positioned so its EDGE is at pivot point (spine edge) */}\n            <mesh position={[dimensions.width / 2, 0, 0]}>\n              <planeGeometry args={[dimensions.width, dimensions.height]} />\n              <meshStandardMaterial\n                color=\"#ff0000\"\n                transparent\n                opacity={0.8}\n                side={THREE.DoubleSide}\n                emissive=\"#ff0000\"\n                emissiveIntensity={0.5}\n              />\n            </mesh>\n          </group>\n        );\n      })()}\n    </group>\n  );\n}\n","/**\n * Scene Component\n * Sets up lights, camera, and environment\n */\nimport { OrbitControls } from '@react-three/drei';\n\nexport function Scene({ children }: { children: React.ReactNode }) {\n  return (\n    <>\n      {/* Lights - matching concept.html */}\n      <ambientLight intensity={0.8} />\n      <pointLight \n        position={[5, 5, 5]} \n        intensity={1} \n        distance={50}\n        color=\"#00ffcc\"\n      />\n      \n      {/* Camera controls */}\n      <OrbitControls \n        makeDefault\n        enableDamping\n        dampingFactor={0.05}\n      />\n      \n      {/* Book content */}\n      {children}\n    </>\n  );\n}\n\n"],"names":["REACT_ELEMENT_TYPE","REACT_FRAGMENT_TYPE","jsxProd","type","config","maybeKey","key","propName","reactJsxRuntime_production","getComponentNameFromType","REACT_CLIENT_REFERENCE","REACT_PROFILER_TYPE","REACT_STRICT_MODE_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_ACTIVITY_TYPE","REACT_PORTAL_TYPE","REACT_CONTEXT_TYPE","REACT_CONSUMER_TYPE","REACT_FORWARD_REF_TYPE","innerType","REACT_MEMO_TYPE","REACT_LAZY_TYPE","testStringCoercion","value","checkKeyStringCoercion","JSCompiler_inline_result","JSCompiler_temp_const","JSCompiler_inline_result$jscomp$0","getTaskName","name","getOwner","dispatcher","ReactSharedInternals","UnknownOwner","hasValidKey","hasOwnProperty","getter","defineKeyPropWarningGetter","props","displayName","warnAboutAccessingKey","specialPropKeyWarningShown","elementRefGetterWithDeprecationWarning","componentName","didWarnAboutElementRef","ReactElement","owner","debugStack","debugTask","refProp","jsxDEVImpl","isStaticChildren","children","isArrayImpl","validateChildKeys","keys","k","didWarnAboutKeySpread","node","isValidElement","object","React","require$$0","createTask","callStackForError","unknownOwnerDebugStack","unknownOwnerDebugTask","reactJsxRuntime_development","trackActualOwner","jsxRuntimeModule","require$$1","createStoreImpl","createState","state","listeners","setState","partial","replace","nextState","previousState","listener","getState","api","initialState","createStore","identity","arg","useStore","selector","slice","createImpl","useBoundStore","create","animateValue","from","to","duration","setter","easing","t","startTime","animate","currentTime","elapsed","progress","easedProgress","easeInOutCubic","createBookStore","initProps","DEFAULT_PROPS","set","get","count","validCount","currentPage","page","pageCount","validPage","direction","flippingPageIndex","isFlippingContinuously","newPage","continuousDirection","dims","current","newDimensions","estimatedPageCount","rotation","tilt","scale","position","hinge","opacity","color","intensity","text","width","font","enabled","score","debug","angle","targetAngle","flipped","flipNext","flipDuration","emotion","pulseCycles","maxPulses","pulseDuration","pulse","dimPulseCycles","maxDimPulses","dimPulseDuration","dimPulse","originalRotation","originalTilt","shakeIntensity","shakeCount","shakeDuration","shakes","shake","randomRotation","randomTilt","material","v","BookContext","createContext","BookProvider","storeRef","useRef","useBookStore","store","useContext","Page","index","totalPages","glow","coverWidth","coverHeight","pageWidth","pageHeight","spineDepth","isAttachedToBack","availableDepth","zOffset","jsxs","jsx","THREE","useCoverTexture","textColor","outlineColor","outlineWidth","isFront","fontFamily","useMemo","canvas","ctx","lines","fontSize","startY","line","i","y","words","maxWidth","currentLine","currentY","word","wordIndex","testLine","texture","Cover","side","height","spineWidth","coverThickness","pivotX","pivotZ","hingeRotation","Spine","depth","Particles","bookDimensions","pointsRef","positions","velocities","i3","useFrame","delta","positionAttr","effectiveIntensity","Book","bookGroupRef","dimensions","spineRotation","frontHinge","backHinge","pageOpacity","pageColor","glowIntensity","coverColor","coverOpacity","spineColor","frontCoverText","backCoverText","coverTextColor","coverOutlineColor","coverOutlineWidth","particlesEnabled","particleIntensity","testPageFlipAngle","flipProgress","flipDirection","safePosition","Fragment","Html","_","pageIndex","pageRotation","Scene","OrbitControls"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}